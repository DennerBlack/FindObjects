# Нахождение маркеров на изображении
## Описание
Задача нахождения объектов на изображении - классическая задача компьютерного зрения. Но в данном наборе изобрачений искомые объекты, маркеры, как и сами изображенмя имеют черезвычайно высокий уровень шумов, из-за того что это скриншоты облака точек.

Для решения такой нетривиальной задачи, после некоторых экспериментов, была использована нейросеть для семантической сегментации на основе UNet. Данная модель получает на вход изображение фиксированного размера (в этом случае 512х512х3), а возвращает маску с метками класса на месте искомых объектов.

Но для нейросети нужны данные, на которых она сможет учится. Разбив все изображения(кроме одного) на одинаковые кусочки удалось получить 14 масок с  маркерами, для обучения можно использовать только 13 из них, а одну оставить для оценки качества обучения модели. Для увилечения обучающей выборки была произведена аугментация данных, добовление в выборку исходных, но немного изменненых данных.

Ввиду того, что уровен зашумленности в районе маркеров разный было собрано 2 датасета из одного было выбрано изображение для оценки с высоким уровнем шумов у маркера(hard), а из другого с более низким(normal). 

На основе обученной сети был разработан детектор способный принимать на вход изображение произвольного размера и выдавать маску и размеченное изображение с указанием на центры найденных маркеров. Модуль SCNN использует дифферинциальную архитектуру, тоесть подгружается несколько моделей, в данном случае 2, а потом коитоговый выриант выдачи строится толькона частях что общие для выдачи обоих моделей, это позволяет избавится от большого количества шумов даваемых каждой моделью по-отдельности. Итоговый вариант маски проходит обработку для отсечения малых остаточных шумов и сглаживания контуров предсказанных масок. После, на маске находятся отдельные скопления пикселей, вычисляются их центры и наносятся на копию изначального изображения.
## Стркутура проекта 
```
.
├── data
│   ├── dataset
│   │   ├── hard
│   │   ├── normal
│   │   └── test
│   └── images
│       ├── Screenshot_4.png
│       ├── target
│       ├── target_source.png
│       ├── template.png
│       ├── tmp2.png
│       └── validation
├── main.py
├── Prepare.py
├── requirements.txt
├── SCNN.py
├── SCNN_train.py
└── weights
    ├── scnn_E100_v0_hard.h5
   ...
    └── scnn_E50_v1_normal.h5
```
Для начала необходимо чтобы на компьютере были установлены Python, CUDA и CUDNN. Установить требуемые модули python можно выполнив команду ниже
```
pip install –r requirements.txt
```

